# SoCureLLM论文总结
## 一、论文基本信息
- 标题：SoCureLLM: An LLM-driven Approach for Large-Scale System-on-Chip Security Verification and Policy Generation
- 作者：Shams Tarek、Dipayan Saha等（美国佛罗里达大学电气与计算机工程系）
- 发表会议：IEEE International Symposium on Hardware Oriented Security and Trust (HOST)
- 发表年份：2025年
- 研究方向：大型片上系统（SoC）安全验证、安全政策生成、大语言模型（LLM）应用

## 二、摘要
现代SoC复杂度提升，现有硬件安全验证方法存在适应性、扩展性和可用性不足的问题。LLM虽具备自然语言理解和知识迁移能力，但受限于token长度和记忆约束，难以应用于大型设计。为此提出SoCureLLM框架，通过设计分区、上下文总结和优化提示策略，实现大型SoC漏洞检测和安全政策数据库构建。该框架在3个易受攻击的RISC-V SoC中检测出76.47%的安全漏洞，优于现有方法，还为3个大型RISC-V SoC生成84个新安全政策。

## 三、研究背景
- 现代SoC集成第三方知识产权（3PIP），设计复杂且采用横向开发流程，安全验证至关重要。
- 硬件安全漏洞来源多样，包括设计失误、恶意操作、CAD工具优化缺陷等，可能导致巨额损失和产品召回。
- 行业向SoC安全开发生命周期（SDL）转型，但现有验证工具侧重功能而非安全，易遗漏硅前阶段关键漏洞。
- 现有安全验证方法（如信息流跟踪、断言验证等）存在扩展性差、适应性不足、需大量人工和计算资源的问题。

## 四、研究动机
- 现有SoC安全验证方法无法满足大型设计的需求，且依赖大量人工干预，操作门槛高。
- LLM的模式识别、知识迁移能力适合解决上述问题，但固定上下文长度导致其难以处理大型设计。
- 缺乏能同时实现大型SoC漏洞自动化检测和安全政策生成的一体化框架，需突破LLM的token和记忆限制。

## 五、实验流程
### 1. 核心流程
1. 设计分区：用Python工具将Verilog代码按IP模块、代码行数、Verilog结构等规则分割为小型代码片段。
2. 上下文总结：Summarizer LLM为每个代码片段生成包含信号、安全和功能信息的简洁摘要，用于补充上下文。
3. 安全政策违规检测：Detector LLM采用双假设提示策略，结合代码片段和历史摘要递归分析，生成明确违规报告或非结论报告。
4. 新安全政策生成：Finder LLM基于威胁模型提示识别潜在攻击点，Generator LLM将其转化为安全政策。
5. 政策审核：人工筛选重复、不可行的政策，保留有效政策存入数据库。

### 2. 关键设置
- 核心LLM：采用GPT-4 API。
- 实验对象：3个漏洞RISC-V SoC（hack@dac 2018、TrustHub基准、HOST 2022）用于漏洞检测；3个开源RISC-V SoC（CVA6、lowRISC等）用于政策生成。
- 辅助工具：Verilator、Cadence Incisive用于仿真，Cadence Jaspergold SPV/FPV用于形式验证。

## 六、实验结果
- 漏洞检测性能：在68个硬件漏洞中，SoCureLLM的真阳性率（TPR）达76.47%，显著高于开放式LLM方法（35.29%），真阴性率（TNR）为96.46%。
- 与传统方法对比：比最接近的仿真方法多检测16.18%的漏洞，分析速度更快（如MMU模块分析仅需15分钟，而形式验证工具需1小时）。
- 政策生成成果：为3个大型SoC生成84个新安全政策，覆盖信息泄露、权限提升等多类威胁场景。
- 成本优势：完整分析hack@dac 2018 SoC仅需约7.5美元，远低于商业工具和上市延迟成本。

## 七、主要贡献
- 提出首个能处理大型SoC设计的LLM基安全验证框架。
- 通过设计分区、上下文总结解决LLM的token限制和记忆问题，兼具扩展性和灵活性。
- 实现自动化漏洞检测方法，无需大量人工干预。
- 构建基于威胁模型的安全政策生成流程，丰富安全政策数据库。
- 通过多类SoC设计验证，证明框架优于现有验证方法。

## 八、创新点
- 设计分区策略：按Verilog结构和功能模块拆分大型设计，适配LLM的token处理能力。
- 上下文总结机制：保留代码片段关键信息，解决LLM上下文 retention 问题。
- 双假设提示策略：要求LLM同时分析“违规假设”和“合规假设”，提升检测准确性。
- 一体化流程：整合漏洞检测与政策生成，形成从漏洞识别到防护指导的完整闭环。

## 九、局限性
- 对隐蔽性强的硬件木马检测效果有限，难以识别复杂 stealthy 漏洞。
- 无法有效检测跨模块漏洞，仅聚焦单个模块内的安全问题。
- 生成的安全政策需人工审核，仍存在一定的人工依赖。
- 性能依赖LLM的能力，对未见过的新型漏洞检测效果可能下降。

## 十、未来展望
- 微调专门用于硬件安全验证的LLM，提升领域内漏洞检测精度。
- 增加跨模块交互分析机制，解决跨模块漏洞检测问题。
- 扩大硬件木马数据集，优化LLM对隐蔽漏洞的识别能力。