# Harnessing the Power of General-Purpose LLMs in Hardware Trojan Design 论文总结
## 一、论文基本信息
- 标题：Harnessing the Power of General-Purpose LLMs in Hardware Trojan Design
- 作者：Georgios Kokolakis、Athanasios Moschos、Angelos D. Keromytis（佐治亚理工学院，美国）
- 发表会议：ACNS 2024 Workshops（LNCS 14586）
- 发表年份：2024年
- 研究方向：通用大语言模型（LLM）在硬件木马（HT）设计中的应用、复杂硬件设计的木马插入自动化、RISC-V架构安全攻击验证

## 二、摘要
LLM已在软件工程和网络安全领域展现自动化潜力，但在硬件安全（尤其是攻击性安全）领域应用尚处于起步阶段。本文探索通用LLM对攻击者插入硬件木马的辅助能力，重点解决LLM上下文长度限制带来的复杂硬件设计分析难题。通过让LLM关联系统级安全概念与硬件模块抽象，筛选目标代码片段，定位安全相关功能实现，最终修改代码插入木马功能。以现代RISC-V微架构为目标，设计并实现了一个真实硬件木马，在FPGA板上验证其对CPU完整性和可用性的攻击效果，证明通用LLM可辅助攻击者高效导航复杂硬件设计并完成实用化木马攻击。

## 三、研究背景
- LLM在软件工程中已广泛应用于代码生成、漏洞检测与修复，但硬件领域因HDL代码库稀缺、生成可综合HDL代码难度高，应用相对滞后。
- 硬件安全领域中，LLM此前多聚焦于形式验证、安全硬件生成、漏洞检测，而在硬件木马插入等攻击性场景中，缺乏自动化流程。
- 复杂硬件设计（如CPU）包含大量HDL文件和代码行，LLM的上下文长度限制使其难以直接分析完整设计，现有方案多依赖人工筛选目标代码，效率低下。
- 硬件木马是恶意修改硬件逻辑的攻击手段，传统插入需攻击者深入理解设计细节，耗时且门槛高。

## 四、研究动机
- 现有硬件木马插入依赖人工分析复杂HDL代码库，效率低且对攻击者专业知识要求高，亟需自动化工具辅助。
- LLM的自然语言理解和代码分析能力可降低硬件木马设计门槛，但上下文长度限制成为分析大型硬件设计的关键障碍。
- 需验证通用LLM在攻击性硬件安全中的实用价值，探索“系统级概念→目标模块→代码定位→木马插入”的自动化流程可行性。

## 五、实验流程
### 1. 核心流程（两阶段自动化流程）
#### 阶段1：上下文长度缩减与目标模块筛选
1. 攻击者明确高层攻击场景（如非法内存访问、密钥泄露），向LLM提交自然语言查询，关联系统级安全概念与硬件模块（如“处理特权级分离的CPU模块”）。
2. LLM返回目标模块名称及功能描述，筛选出仅需分析的模块，将分析范围从完整设计缩小至单个/少数模块，突破上下文长度限制。

#### 阶段2：目标代码定位与木马插入
1. 向LLM提交目标模块的HDL代码，获取模块功能概要，进一步指令LLM定位与攻击目标相关的代码片段（如异常生成逻辑、特权检查逻辑）。
2. 攻击者通过自然语言指令，要求LLM在不破坏原有功能的前提下，修改目标代码插入木马载荷（如禁用非法访问异常）。
3. 设计触发电路（如监控特定寄存器值），确保木马仅在攻击者指定条件下激活，提升隐蔽性。
4. 对修改后的设计进行功能测试、综合与FPGA部署，验证木马有效性。

### 2. 关键设置
- 实验对象：DES加密算法、AES加密算法、CVA6 RISC-V 64位微处理器（96个HDL文件，28559行代码）。
- 核心工具：GPT-3.5/4（通用LLM）、Xilinx Vivado（FPGA开发工具）、Genesys 2 FPGA板（硬件验证平台）。
- 攻击场景：DES加密轮数缩减、AES密钥泄露、CVA6投机执行攻击、热攻击导致性能下降、违反OS内存策略（用户态访问内核内存）。

## 六、实验结果
- 模块筛选效果：LLM成功关联5类系统级概念与对应硬件模块，如将“特权级分离”关联到MMU模块，筛选后分析范围从数十个HDL文件缩减至1个。
- 多场景攻击验证：成功在DES、AES、CVA6上实现5类木马攻击，LLM准确定位目标代码并生成可综合的修改方案。
- CVA6木马实战效果：在FPGA上部署含木马的CVA6，成功实现用户态进程访问并修改内核内存：
  - 完整性攻击：篡改Linux内核模块（LKM）数据，破坏内核完整性。
  - 可用性攻击：修改init_task结构，导致内核恐慌。
- 木马隐蔽性：木马仅占用26个LUTs和1个FF（载荷电路），相对于CVA6的整体资源占用（72606 LUTs、47178 FFs）， footprint极小，难以被常规检测发现。

## 七、主要贡献
- 提出首个基于通用LLM的硬件木马自动化插入流程，解决LLM上下文长度限制对复杂硬件设计分析的影响。
- 实现“系统级概念→目标模块→代码定位→木马插入”的端到端自动化，降低硬件木马设计门槛。
- 在真实RISC-V微架构上完成硬件木马实战验证，证明方案的实用性和有效性。
- 探索了LLM在攻击性硬件安全中的应用潜力，为后续相关研究提供参考框架。

## 八、创新点
- 以LLM为“智能过滤器”：通过自然语言交互关联系统级安全概念与硬件模块，自动化筛选目标代码，无需人工预处理HDL文件。
- 无领域微调依赖：基于通用LLM实现硬件木马插入，无需针对硬件领域微调模型，降低应用成本。
- 隐蔽性触发设计：结合LLM生成触发电路（如寄存器值监控），确保木马仅在攻击者控制条件下激活。

## 九、局限性
- 实验仅使用GPT-3.5/4两种通用LLM，未验证领域专用LLM的性能差异，设计数据集规模较小（3类核心设计）。
- 未考虑极端情况：若目标模块的HDL代码行数超LLM上下文长度，现有流程无法直接处理。
- 未探索LLM参数（如温度）对木马代码质量（隐蔽性、功能性）的影响。
- 缺乏自动化的木马有效性验证框架，需人工进行功能测试和FPGA部署。

## 十、未来展望
- 扩展实验范围：纳入更多通用LLM和领域专用LLM，测试更大规模、更多类型的硬件设计（如SoC、加密模块）。
- 优化上下文处理：针对超长度模块代码，开发基于tokenization的分段分析策略，进一步提升流程自动化程度。
- 研究参数微调：探索LLM参数调整对木马代码隐蔽性、功能性的影响，优化生成质量。
- 构建验证框架：开发自动化工具验证LLM生成木马的有效性、隐蔽性，减少人工干预。
- 融入最新HT研究：将硬件木马领域的最新成果（如低功耗、抗检测技术）纳入LLM反馈循环，提升生成木马的攻击性能。