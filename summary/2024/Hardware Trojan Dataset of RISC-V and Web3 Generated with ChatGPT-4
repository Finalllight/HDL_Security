# Hardware Trojan Dataset of RISC-V and Web3 Generated with ChatGPT-4 论文总结
## 一、论文基本信息
- 标题：Hardware Trojan Dataset of RISC-V and Web3 Generated with ChatGPT-4
- 作者：Victor Takashi Hayashi、Wilson Vicente Ruggiero（巴西圣保罗大学工学院）
- 发表期刊：Data（MDPI）
- 发表年份：2024年
- 研究方向：硬件木马数据集构建、RISC-V与Web3硬件安全、大语言模型（LLM）辅助数据生成

## 二、摘要
硬件木马对RISC-V和Web3应用的硬件安全构成重大威胁，但现有数据集案例有限——知名的TrustHub仅含106个木马，RISC-V相关研究仅涉及3-4个案例，Web3领域（如硬件钱包、矿机）尚无相关数据集。本文基于29个黄金模型和TrustHub分类法，利用ChatGPT-4生成290个Verilog硬件木马示例，涵盖RISC-V、硬件钱包和工作量证明（PoW）矿机三类硬件。该数据集可为RISC-V和Web3硬件的木马检测防御研究提供支撑。

## 三、研究背景
- 开源硬件（如RISC-V）凭借透明度优势广泛应用于关键场景，但仅开放代码不足以保障安全，需通过验证排查硬件木马。
- RISC-V已成为物联网、云边计算等领域的标准架构，Web3相关硬件（硬件钱包、PoW矿机）用户规模激增，但两类硬件的木马防御研究滞后。
- 现有硬件木马数据集存在明显不足：TrustHub案例数量少、无RISC-V大型设计案例、缺乏Web3硬件相关示例；其他数据集仅聚焦AES、RSA等传统模块，覆盖范围有限。
- 人工生成硬件木马效率低、难以规模化，无法满足防御机制训练对大数据集的需求。

## 四、研究动机
- 现有数据集案例少、覆盖范围窄，难以支撑RISC-V和Web3硬件的木马检测研究。
- 人工生成硬件木马规模化难度大，需探索自动化、高效的数据生成方式。
- 验证通用LLM（如ChatGPT-4）结合硬件木马分类法，生成高质量专用数据集的可行性。

## 五、实验流程
### 1. 核心流程（基于提示工程的自动化生成）
1. 上下文铺垫：用户告知LLM研究目的（生成木马用于检测模型训练），避免其因安全限制拒绝生成。
2. 分类法上传：向ChatGPT-4提供TrustHub硬件木马分类法PDF，明确木马生成的类型依据。
3. 黄金模型输入：将RISC-V、硬件钱包、PoW矿机的Verilog黄金模型直接嵌入提示，要求LLM基于分类法生成木马变体。
4. 质量验证：使用Verilator工具（PyVerilator 0.7.0）对生成的木马代码进行仿真测试，检查语法错误、逻辑问题等。
5. 检测验证：用ChatGPT-4对生成的木马进行检测实验，通过“反思提示”优化检测结果。

### 2. 关键设置
- 黄金模型：共29个，包括RISC-V（15个模块）、硬件钱包（5个模块，含SHA-256哈希等）、PoW矿机（9个模块，含UART通信等）。
- 生成规则：每个黄金模型对应10个木马示例，严格遵循TrustHub分类法。
- 验证工具：Verilator（代码质量检测）、PyVerilog（HDL解析）、Yosys+nextpnr（电路综合验证）。

## 六、实验结果
- 数据集规模：生成290个Verilog硬件木马示例，平均文件大小2744字节，部分生成代码因逻辑简化，体积小于对应黄金模型。
- 木马类型分布：仅生成两类木马——条件型（如特定输入触发）和时间型（如时钟周期计数触发），未覆盖TrustHub分类法中的物理条件型、始终激活型等。
- 代码质量：Verilator检测显示，三类硬件的生成代码均存在少量警告（如缺失默认case语句），但不影响基础功能仿真。
- 检测效果：ChatGPT-4对生成木马的检测准确率在“反思提示”后提升，可正确识别RV32I_Top模块中的条件触发木马，修正对CTLR_Unit_RV32I模块中不可达逻辑的误判。

## 七、主要贡献
- 构建了首个针对RISC-V和Web3硬件（硬件钱包、PoW矿机）的大规模硬件木马数据集，含290个示例，填补领域空白。
- 提出基于ChatGPT-4和TrustHub分类法的自动化数据集生成方法，无需人工编写木马代码，效率远超传统方式。
- 验证了LLM在硬件木马数据生成中的有效性，同时完成生成数据的检测验证，形成“生成-检测”闭环。

## 八、创新点
- 首次将通用LLM与硬件木马分类法结合，专门生成RISC-V和Web3领域的木马示例，拓展了LLM在硬件安全数据生成中的应用场景。
- 设计了三步提示工程策略，解决了LLM因安全限制拒绝生成恶意代码的问题，保障生成流程顺畅。
- 同时覆盖传统RISC-V架构和新兴Web3硬件，数据集实用性强，支持多场景防御研究。

## 九、局限性
- 木马类型单一：仅生成条件型和时间型木马，缺失物理条件型、始终激活型等复杂类型，多样性不足。
- 代码复杂度低：生成的木马逻辑相对简单，与真实场景中隐蔽性强的复杂木马存在差距。
- 存在质量隐患：部分生成代码存在Verilator警告，需人工二次验证才能用于正式研究。
- 依赖单一LLM：仅使用ChatGPT-4生成，未验证其他LLM的生成效果。

## 十、未来展望
- 扩展生成能力：通过提示工程补充复杂木马示例，或微调开源LLM，生成物理条件型、分布式木马等缺失类型。
- 优化代码质量：结合Retrieval-Augmented Generation（RAG）技术，提升生成代码的可综合性和安全性。
- 对抗性生成：采用“红队-蓝队”模式，用无审查LLM生成木马，ChatGPT-4检测，迭代生成更难检测的复杂木马。
- 扩展应用场景：将生成方法推广到后量子硬件等新兴领域，丰富数据集覆盖范围。
- 多工具验证：结合UCI、FANCI等传统检测工具，对数据集进行全面验证，提升可信度。