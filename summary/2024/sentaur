# SENTAUR论文总结
## 一、论文基本信息
- 标题：SENTAUR: Security EnhaNced Trojan Assessment Using LLMs Against Undesirable Revisions
- 作者：Jitendra Bhandari、Rajat Sadhukhan等（纽约大学，美国）
- 发表状态：arXiv预印本（2024年7月）
- 研究方向：硬件木马（HT）生成与评估、寄存器传输级（RTL）安全、大语言模型（LLM）辅助硬件安全工具开发

## 二、摘要
全球化集成电路（IC）供应链中，第三方IP/EDA工具带来硬件木马风险，可能导致功能异常、敏感数据泄露等问题。现有TrustHub基准数据集仅含少量人工创建的木马，且多数在合成后失效，传统工具需训练机器学习模型才能生成木马，难以复现。为此提出LLM基框架SENTAUR，通过学习RTL设计规格、描述及木马效果的自然语言说明，快速生成可合成、实用的硬件木马，无需训练周期。该框架可泛化用于RTL代码的指定功能修改，在TrustHub基准和双端口RAM上验证，生成的木马经Xilinx FPGA测试，合成后功能有效，开销与人工设计相当。

## 三、研究背景
- 现代SoC设计依赖第三方IP/EDA工具，外包模式虽降低成本、加速开发，但引入不可信第三方注入硬件木马的风险，且硅后阶段移除木马成本极高。
- 现有硬件木马数据集存在缺陷：TrustHub仅覆盖少量木马场景，且79/83个基准木马合成后失效，无法满足防御机制评估需求。
- 传统木马生成工具（如MIMIC、Trojan Playground）需大量训练时间，或依赖人工选择触发网，效率低、灵活性差。
- RTL级是插入和防御木马的关键阶段，需平台无关、自动化的工具，实现快速生成和评估木马。

## 四、研究动机
- 现有木马数据集规模小、合成后有效性低，难以支撑全面的防御评估。
- 传统木马生成工具依赖模型训练或人工干预，流程复杂、耗时久，无法快速响应多样化攻击场景。
- 需验证LLM生成“合成后仍有效”的硬件木马的可行性，构建灵活、无训练周期的自动化评估框架。

## 五、实验流程
### 1. 核心流程（三阶段自动化框架）
1. RTL生成/分析：向LLM输入设计规格、木马触发类型（如时间型、状态型）和载荷效果（如DoS、信息泄露），生成含木马的可合成RTL代码。
2. 设计合成：使用商用/开源工具（如Xilinx Vivado）将生成的RTL合成为门级网表。
3. 设计验证：通过仿真工具和FPGA平台（Xilinx Zynq-7000）验证合成后木马的功能正确性和有效性。

### 2. 关键设置
- 核心LLM：GPT-4。
- 实验对象：TrustHub基准（AES-T600、AES-T800、AES-T900）、Xilinx双端口RAM IP（含处理系统PS）。
- 触发与载荷组合：5类触发（时间型、逻辑型、地址型、状态型、输入型）×3类载荷（DoS、性能降级、信息泄露）。
- 验证平台：Xilinx Zynq-7000系列FPGA（xc7z020clg400-1），搭建Linux镜像并通过Python控制读写内存。

## 六、实验结果
- 木马合成有效性：LLM生成的AES-T800等木马，合成后触发逻辑正常——检测到预设输入序列后，触发信号正确置高，解决了原始TrustHub基准合成后失效的问题。
- 资源开销：生成的木马与人工设计的木马在LUT（查找表）和FF（触发器）占用上相当（如时间型DoS木马：GPT-4生成需791 LUT，人工设计需777 LUT），无显著额外开销。
- 评估能力：LLM可针对逻辑、状态机、I/O引脚、信号四类维度，自动标记木马代码中的可疑点，辅助防御方快速定位风险。

## 七、主要贡献
- 提出首个基于对话式LLM的硬件木马生成框架，生成的木马经合成后仍保持功能有效性。
- 框架灵活且平台无关，可用于攻击者插入木马、防御者评估漏洞、设计者集成功能模板等多场景。
- 通过Xilinx FPGA验证框架实用性，证明生成的木马在真实硬件上可触发预期恶意效果。
- 提供TrustHub木马净化机制，将无效木马转化为合成后功能正确的版本。

## 八、创新点
- 无训练周期：无需训练机器学习模型，通过自然语言提示直接生成木马，大幅提升效率。
- 合成有效性保障：LLM生成代码时规避 latch 等合成隐患，确保木马在门级网表中仍能正常工作。
- 泛化能力：不仅用于木马生成，还可自动化修改RTL以实现任意指定功能，适用范围广。

## 九、局限性
- 目前仅聚焦RTL级木马生成，尚未扩展到后合成网表的功能插入。
- 生成的木马类型依赖触发与载荷的预设组合，对更复杂的分布式木马支持有限。
- 评估维度虽覆盖逻辑、状态机等核心点，但对物理条件触发的木马生成能力未充分验证。

## 十、未来展望
- 扩展框架功能，支持在后合成网表中插入指定功能（含木马）。
- 增加复杂木马类型生成，如物理条件触发、分布式木马。
- 优化LLM提示策略，进一步提升木马的隐蔽性和多样性。
- 拓展至更多硬件类型（如SoC、专用加密芯片）的木马生成与评估。