# SCAR论文总结
## 一、论文基本信息
- 标题：SCAR: Power Side-Channel Analysis at RTL-Level
- 作者：Amisha Srivastava、Sanjay Das等（美国得克萨斯大学达拉斯分校、技术创新研究所等机构）
- 发表状态：arXiv预印本（2023年10月）
- 研究方向：寄存器传输级（RTL）功率侧信道分析、加密硬件漏洞检测与自动加固、图神经网络（GNN）与大语言模型（LLM）应用

## 二、摘要
功率侧信道攻击利用加密硬件的动态功耗泄露敏感信息，现有分析多集中于硅后阶段，修改成本高且灵活性差。为此提出SCAR框架，一种基于GNN的硅前RTL级功率侧信道分析方案。该框架将加密硬件RTL设计转化为控制数据流图（CDFG），通过GNN检测易泄露模块，结合深度学习解释器生成可量化的检测说明，并利用LLM自动生成加固代码插入漏洞区域。在AES、RSA、PRESENT等传统加密算法及Saber、CRYSTALSKyber等后量子加密算法上评估，SCAR实现最高94.49%的定位准确率、100%精确率和90.48%召回率，同时通过可解释性分析将GNN训练特征减少57%，且保持精度相当。

## 三、研究背景
- 功率侧信道（PSC）攻击通过监测加密运算中的动态功耗变化，提取密钥等敏感信息，威胁智能卡、安全微控制器等嵌入式系统安全。
- 现有PSC分析多在硅后阶段进行，发现漏洞后难以 retrofit安全措施，导致高昂的设计重制成本。
- 硅前阶段的RTL级分析可早期发现漏洞、降低修改成本，但现有RTL级分析方法存在计算量大、需复杂功率估算模型、仅支持模块级分析且缺乏加固策略等问题。
- GNN擅长处理图结构数据，LLM具备代码生成能力，为RTL级漏洞检测与自动加固提供了技术支撑。

## 四、研究动机
- 硅后PSC分析修改成本高、灵活性差，亟需高效的硅前RTL级分析方案实现早期漏洞检测。
- 现有RTL级PSC分析方法计算复杂、检测粒度粗（仅到模块级），且未整合自动加固功能，无法满足工程需求。
- 需解决“检测-解释-加固”的全流程自动化问题，减少人工干预，提升加密硬件设计的安全性与开发效率。

## 五、实验流程
### 1. 核心流程
1. CDFG生成与节点预处理：利用GOLDMINE工具将RTL设计转化为CDFG，提取节点特征（脆弱路径数、节点度数、汉明距离、运算类型等）。
2. GNN模型训练与漏洞模块检测：基于AES Comp基准训练二分类GNN模型，将CDFG节点分为“易泄露”和“非易泄露”，定位漏洞模块。
3. 可解释性分析：通过GNN-Explainer生成特征重要性评分和子图，筛选关键特征，优化模型。
4. RTL行级漏洞定位：通过节点与RTL代码行映射、易泄露节点识别、频率分析、漏洞排序及源代码分析，精准定位漏洞代码行。
5. 自动加固：基于预训练LLM（Falcon-7B），通过布尔掩码技术生成加固代码，替换漏洞行。

### 2. 关键设置
- 实验对象：AES系列（AES TBL、AES PPRM1等）、RSA1024 RAM、PRESENT等传统加密算法，Saber、CRYSTALSKyber等后量子加密算法。
- 核心工具：GOLDMINE（CDFG生成）、Icarus Verilog（RTL仿真）、Synopsys VCS/Design Vision（后综合验证）、Falcon-7B（LLM加固）。
- GNN模型参数：输入层7个神经元（对应7类节点特征），2个图卷积层，输出层采用sigmoid激活函数，学习率0.01，批次大小20，训练32轮。

## 六、实验结果
- 漏洞模块检测性能：在未见过的AES实现上最高达94.49%准确率、100%精确率和97.88%召回率；在RSA、PRESENT及后量子算法上，准确率最高91.84%、精确率85.94%、召回率94.62%。
- 行级定位效果：成功定位AES的Sbox/MixColumns模块、RSA的ModExpSequencer模块、PRESENT的Sbox模块等漏洞行，且这些行在后综合阶段被证实动态功耗最高。
- 加固效果：LLM生成的布尔掩码代码可有效掩盖漏洞行的功耗泄露，无需人工修改。
- 模型优化：通过可解释性分析筛选出3个关键特征（脆弱路径数、节点度数、汉明距离），特征集减少57%，模型精度仅轻微下降（如AES PPRM1从94.49%降至93.81%）。

## 七、主要贡献
- 提出首个基于GNN的RTL级PSC分析框架SCAR，实现从模块到代码行的细粒度漏洞检测。
- 整合可解释性分析模块，生成量化特征重要性说明，优化模型并提升结果可信度。
- 实现漏洞检测与自动加固全流程自动化，利用LLM生成布尔掩码代码，无需人工干预。
- 在传统加密算法和后量子加密算法上验证有效性，具备良好的泛化能力。
- 通过特征筛选降低模型计算开销，兼顾检测精度与效率。

## 八、创新点
- 基于CDFG的GNN检测方案：将RTL设计转化为图结构，利用GNN捕捉节点局部结构与邻域影响，适配RTL设计的内在关联特性。
- 可解释性驱动的模型优化：通过GNN-Explainer筛选关键特征，在不损失精度的前提下简化模型，降低计算成本。
- LLM自动加固机制：针对定位到的漏洞行，利用LLM生成布尔掩码代码，实现“检测-加固”闭环，提升开发效率。
- 细粒度定位能力：从模块级深入到RTL代码行级，为精准加固提供支撑。

## 九、局限性
- 对部分复杂隐蔽的漏洞（如特殊构造的硬件木马）检测能力可能不足。
- 加固策略目前仅采用布尔掩码，未覆盖所有类型的功率侧信道攻击防护手段。
- LLM的加固效果依赖训练数据集质量，对未见过的漏洞类型可能生成非最优代码。
- 模型泛化性受限于训练所用的加密算法类型，需扩展更多算法数据以提升适应性。

## 十、未来展望
- 扩展加固策略库，整合除布尔掩码外的多种防护技术（如随机化、混淆等）。
- 优化GNN模型结构，提升对隐蔽漏洞和复杂加密算法的检测能力。
- 扩大LLM训练数据集，纳入更多加密算法的漏洞案例，提升加固代码的有效性与通用性。
- 探索SCAR与电子设计自动化（EDA）工具的集成，融入现有硬件设计流程。