# (Security) Assertions by Large Language Models
核心结论：该论文首次系统探究了大型语言模型（LLM）自动生成硬件安全断言的可行性，提出了自动化评估框架和基准套件，证实合适的提示词配置下LLM生成断言的准确率可达93.55%，为硬件安全验证提供了高效新路径。

## 一、论文基本信息
- 标题：(Security) Assertions by Large Language Models
- 发表期刊：IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY
- 发表年份：2023（录用时间）
- 作者：Rahul Kande、Hammond Pearce等7人
- 作者单位：德州农工大学、新南威尔士大学、卡尔加里大学、纽约大学
- 关键词：LLM、AI、硬件、断言生成、硬件安全、漏洞检测、ChatGPT、Codex
- 安全关键词：硬件漏洞

## 二、摘要
硬件是系统信任根，漏洞会引发严重后果，断言式验证是关键硬件验证技术，但安全导向的断言生成难度高。本文探究了LLM基于自然语言提示词（如断言文件中的代码注释）生成SystemVerilog安全断言的能力，聚焦主流LLM，设计了包含多种提示词的评估框架和由真实硬件设计、黄金参考断言组成的基准套件，首次验证了LLM生成硬件安全断言的可行性。

## 三、研究背景
- 硬件支撑从物联网设备到多核处理器的各类应用，加密、机器学习等任务依赖硬件加速，硬件漏洞会影响所有依赖它的应用和安全防御。
- 硬件漏洞发现越晚修复成本越高，流片后发现的漏洞难以修复，即便软件补丁也会带来性能开销，还可能导致信息泄露和企业声誉受损。
- 现有硬件验证技术（测试、形式化验证等）需黄金参考模型或断言，但断言生成需手动操作和专业知识，易出错且扩展性差，安全断言因需检测“不应该存在的弱点”，更难通过自动挖掘生成。

## 四、研究动机
- 手动生成硬件安全断言耗时、易出错，且需要稀缺的硬件安全专业知识，难以满足大规模设计需求。
- LLM在其他语言代码生成中已取得成功（如OpenAI Codex），但尚未被应用于硬件安全断言生成领域。
- 希望通过LLM自动生成硬件安全断言，降低断言使用门槛，推动断言式安全检查的普及，实现漏洞检测“左移”，提升硬件设计安全性。

## 五、实验流程
1. 构建基准套件：包含10个基准（2个手动设计+8个来自Hack@DAC竞赛和OpenTitan开源SoC），涵盖4类CWE漏洞，每个基准提供设计源代码（EmptyDUT、CorrectDUT、BuggyDUT）、黄金参考断言、提示词数据（不同细节的注释、示例断言、断言开头）和测试台。
2. 设计评估框架：由提示词生成器（组合设计源、示例断言、注释、断言开头等生成378种独特提示词）、断言文件生成器（修复语法/排版错误）、模拟器（Siemens Modelsim）和计分板（对比生成断言与黄金断言的违规输入集）组成。
3. 配置LLM与参数：以code-davinci-002为主要评估模型，额外测试code-cushman-001、codegen-2b-ft和ChatGPT；设置温度（0.4、0.9）、频率惩罚（0、0.5、1）等参数，每个提示词生成10个断言，单基准合计22680个断言。
4. 评估流程：生成断言→修复错误→编译与模拟→对比黄金断言→统计准确率。

## 六、实验结果
- 整体性能：LLM可生成正确安全断言，所有基准平均准确率26.54%，最优提示词配置准确率达93.55%，44种提示词配置准确率≥80%。
- 提示词影响：详细注释（DetailedCom）+相关示例断言（DetailedEx/BasicEx）表现最佳，平均准确率超39%；设计源（GoldenDUT/BuggyDUT/EmptyDUT）、断言开头（NormalBeg/ShortBeg/EmptyBeg）和同义词对准确率影响较小。
- 模型差异：code-davinci-002表现最优，可正确生成9个基准的断言；code-cushman-001正确生成7个，codegen-2b-ft生成4个，ChatGPT生成5个（因倾向于解释而非直接生成断言）。
- 常见问题：部分生成断言存在语法错误、变量误用、时序逻辑错误等问题，经简单修复后编译通过率提升至96.69%。

## 七、主要贡献
1. 提出首个评估LLM生成硬件安全断言的框架和基准套件，支持自动修复简单语法错误。
2. 系统评估了主流LLM生成硬件安全断言的能力，明确了其可行性与性能边界。
3. 深入探究了提示词各组成部分（注释、示例、设计源等）对生成效果的影响，给出最优配置建议。
4. 开源了框架和基准套件，为该领域后续研究提供基础支持。

## 八、创新点
1. 首次将LLM应用于硬件安全断言生成场景，填补了该领域研究空白。
2. 设计多维度、可组合的提示词体系，覆盖不同细节程度的注释、示例和设计上下文，全面探究提示词影响机制。
3. 构建包含真实硬件漏洞和多样化CWE类型的基准套件，确保评估结果的实用性和泛化性。
4. 开发自动化评估流程，实现从断言生成到正确性验证的端到端闭环，提升评估效率。

## 九、局限性
1. 基准套件仅覆盖10个基准和4类CWE漏洞，CWE类型和硬件设计场景的覆盖范围可进一步扩展。
2. 测试台为简化验证流程，对信号宽度进行了参数化处理（如32位信号按2位验证），可能影响部分复杂断言的验证结果。
3. 无黄金参考断言时，生成断言的相关性和正确性仍需硬件安全专业知识验证，难以完全自动化。
4. 仅聚焦独立SVA文件中的并发断言，未涉及嵌入硬件设计文件的即时断言生成。

## 十、未来展望
1. 扩展基准套件，纳入更多CWE类型、复杂硬件设计和多样化的自然语言提示词表达方式。
2. 微调开源LLM（如CodeGen）以适配硬件安全断言生成任务，降低对商业LLM的依赖。
3. 探索生成嵌入硬件设计文件的即时断言，拓展LLM在硬件验证流程中的应用场景。
4. 结合形式化验证或回归测试技术，实现无黄金参考断言时生成断言的自动化验证。
5. 将LLM应用于硬件漏洞检测、补丁生成等更多安全验证任务，构建全流程LLM辅助硬件安全框架。
